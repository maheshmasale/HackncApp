<html>
<head>
  <title>Express HTML</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

  <script data-main="/lib/capital_one.js" src="/lib/require-jquery.js"></script>

  <script type="text/javascript">

    $(document).ready(function() {

    require(['atm'], function (atm_inp) {
          atm = atm_inp

      });
      $('#fetchData').click(function() {
        console.log(atmDemo());
      });
    });
    
    
    function atmDemo() {
      console.log('Atm Demo');
      //var bankAtms = atm.initWithKey("4495856d0c2b6947ae81b8ab48802308");

      Config = require('capital_one');
      var atmslist = [];
      var continueFetching = true;
      var nextPage = "/atms?key=4495856d0c2b6947ae81b8ab48802308"

      while(continueFetching)
      {
        var request = $.ajax({ url: Config.baseUrl+nextPage, 
        //data: 'key='+"4495856d0c2b6947ae81b8ab48802308", 
        async: false,
        dataType: 'json'});

        request.complete(function(results) {
          if(results.responseJSON.data.length < 2)
          {
              continueFetching = false;
          }
          nextPage = results.responseJSON.paging.next;
          for(i =0; i < results.responseJSON.data.length; i++){
            atmslist.push(results.responseJSON.data[i]);
          }

        });
        
      }
      return atmslist;
    }
    function function_name(argument) {
        // body...
      }  

  </script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
</head>
<body>
  <div style="margin:100px;">
    <nav class="navbar navbar-inverse navbar-static-top">
  <div class="container">
    <a class="navbar-brand" href="/">Express HTML</a>
    <ul class="nav navbar-nav">
      <li class="active">
        <a href="/">Home</a>
      </li>
      <li>
        <a href="/about">About</a>
      </li>
      <li>
        <a href="/sitemap">Sitemap</a>
      </li>
    </ul>
  </div>
</nav>
    <div class="jumbotron"  style="padding:40px;">
      <button id="fetchData" class="btn btn-primary btn-lg" >Fetch</button>
    </div>
  </div>
</body>
</html>